<h1 name="content" align="center"><a href=""><img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/></a> MSSQL</h1>

<p align="center">
<a href="#-lab1"><img alt="lab1" src="https://img.shields.io/badge/Lab1-2C2E33"></a> 
  <a href="#-lab2"><img alt="lab2" src="https://img.shields.io/badge/Lab2-404146"></a>
  <a href="#-lab3"><img alt="lab3" src="https://img.shields.io/badge/Lab3-5A5D63"></a>
  <a href="#-lab4"><img alt="lab4" src="https://img.shields.io/badge/Lab4-17181C"></a>
  <a href="#-lab5"><img alt="lab5" src="https://img.shields.io/badge/Lab5-9CA3AF"></a>
  <a href="#-lab6"><img alt="lab6" src="https://img.shields.io/badge/Lab6-6B7280"></a> 
  <a href="#-lab7"><img alt="lab7" src="https://img.shields.io/badge/Lab7-4B5563"></a>
  <a href="#-lab8"><img alt="lab8" src="https://img.shields.io/badge/Lab8-71717A"></a>
  <a href="#-lab9"><img alt="lab9" src="https://img.shields.io/badge/Lab9-374151"></a> 
</p>

# <img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Ювелирная мастерская (Вариант №23)
<h3 align="center">
<h3">
  <a href="#client"></a>
  
Каталог ювелирных изделий: название изделия, вид изделия (серьги, кольца, браслеты, броши), список материалов (платина, золото, серебро, различные драгоценные камни и т.д.), вес каждого материала в изделии.
Клиенты: ФИО, адрес, телефон.

Реализовать:
- Подбор изделия клиенту и расчет стоимости с учетом скидок постоянным клиентам.
- Заключение договора на производство 1 или нескольких изделий для клиента
- Подсчет выручки мастерской за заданный период
- Поиск изделий по заданным характеристикам
</h3>
</p>
<img src="https://github.com/user-attachments/assets/e080adec-6af7-4bd2-b232-d43cb37024ac" width="20" height="20"/> Лабораторная работа №1


<p aligh="justify>
<h3>
  <a href="#client"></a>
  Разработать ER-модель данной предметной области: выделить сущности, их атрибуты,
связи между сущностями.
Для каждой сущности указать ее имя, атрибут (или набор атрибутов), являющийся
первичным ключом, список остальных атрибутов.
Для каждого атрибута указать его тип, ограничения, может ли он быть пустым, является ли
он первичным ключом.
Для каждой связи между сущностями указать:
- тип связи (1:1, 1:M, M:N)
- обязательность
ER-модель д.б. представлена в виде ER-диаграммы (картинка)
По имеющейся ER-модели создать реляционную модель данных и отобразить ее в виде
списка сущностей с их атрибутами и типами атрибутов, для атрибутов указать, явл. ли он
первичным или внешним ключом
</h3>
</p3>

#### ER-модель
![image](/lab1/bder1.png)

#### Реляционная модель
![image](/lab1/bd11.png)

# Лабораторная работа №2

<p aligh="justify>
<h3>
  <a href="#client"></a>
В соответствии с реляционной моделью данных, разработанной в Лаб.№1, создать реляционную БД на учебном сервере БД :
- создать таблицы, определить первичные ключи и иные ограничения
- определить связи между таблицами
- создать диаграмму
- заполнить все таблицы адекватной информацией (не меньше 10 записей в таблицах, наличие примеров для связей типа 1:M )

</h3>
</p3>

[SQL-код создания и заполнения таблиц](https://github.com/S1l1c1um/Bd_labss/blob/main/JeweleryStore-database/create%20and%20insert.sql)


#### Диаграмма базы данных
![image](/lab1/dia11.JPG)

# Лабораторная работа №3
[Назад](#content)


Цель: изучить конструкции языка SQL для манипулирования данными в СУБД  MSSQL.

[Часть 1](https://github.com/S1l1c1um/Bd_labss/blob/main/lab3/lab3%20bd%20part%201.docx)

[Часть 2](https://github.com/S1l1c1um/Bd_labss/blob/main/lab3/lab%203%20bd%20part%202.docx)

<a id="lab4"></a>
# Лабораторная работа №4
[Назад](#content)

Создать 4 различных [хранимых процедуры](https://github.com/S1l1c1um/Bd_labss/blob/main/lab4/lab4%20%D1%85%D1%80%D0%B0%D0%BD%D0%B8%D0%BC%D1%8B%D0%B5%20%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D0%B4%D1%83%D1%80%D1%8B.pdf):
1. Процедура без параметров, формирующая список материалов, не входящих ни в одно изделие
2. Процедура, на входе получающая вид изделия и формирующая список изделий этого вида из каталога
3. Процедура, на входе получающая номер договора, выходной параметр – ФИО клиента, заключившего этот договор
4. Процедура, вызывающая вложенную процедуру, которая находит материалы, входящие в наибольшее количество изделий. Главная процедура формирует список изделий из каталога, содержащих эти материалы
	
Создать 3 [пользовательских функции](https://github.com/S1l1c1um/Bd_labss/blob/main/lab4/lab4%20%D0%9F%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D0%B5%20%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8.pdf):
1. Скалярная функция, подсчитывающая выручку мастерской в заданный период
2. Inline-функция, возвращающая список клиентов, принесших наибольшую выручку мастерской с начала текущего года
3. Multi-statement-функция, на входе получающая название 2-х материалов, и возвращающая список изделий из каталога, содержащих наибольшее количество материала 1 среди изделий, содержащих наименьшее количество материала 2
	
Создать 3 [триггера](https://github.com/S1l1c1um/Bd_labss/blob/main/lab4/lab4%20%D0%A2%D1%80%D0%B8%D0%B3%D0%B3%D0%B5%D1%80%D1%8B.pdf):
1. Триггер любого типа на добавление договора – если клиент не 1-й раз делает заказ, то делаем ему скидку: если он был у нас 4 и более раз – 10%, если 2 и более – 5%.
2. Последующий триггер на изменение веса материала для какого-то изделия – если есть клиенты, для которых это изделие находится на этапе изготовления, изменение не производим
3. Замещающий триггер на операцию удаления изделия из каталога – если доход от изготовления этого изделия минимален, и оно не находится на этапе изготовления для какого-то клиента, то удаление производим, в противном случае – выдаем сообщение о невозможности удаления
Обязательно предусмотреть обработку НЕСКОЛЬКИХ записей! (там, где необходимо, использовать КУРСОР!)

<a id="lab5"></a>
# Лабораторная работа №5
[Назад](#content)

[Задание 1.](https://github.com/S1l1c1um/Bd_labss/blob/main/lab5/part1.sql)
Для БД, созданной в Лаб.раб. 1-2, создать 2 роли:
- 1-я роль должна иметь доступ к таблицам, хр. процедурам и др. объектам БД, требующийся для руководителя фирмы (т.е., ему д.б. разрешено просматривать конфиденциальную информацию, удалять, исправлять какие-то сведения, выполнять процедуры и функции). Некоторые права необходимо предоставить с возможностью дальнейшей передачи.
- 2-я роль должна иметь доступ, требующийся для простого сотрудника (просмотр не всей инф-ии, добавление, изменение, удаление – только того, что нужно для работы, выполнение ограниченного набора процедур и функции).

Включить 2-х пользователей, предварительно созданных для каждого студента администратором БД, в эти роли и проверить, что права ролей выполняются для каждого пользователя (для этого под каждым пользователем подключиться к БД).
Необходимо уметь предоставлять права на объекты любого типа, отзывать выданные права, давать полный запрет на выполнение некоторых действий. (через команды T-SQL и интерфейс SQL Server Management Studio (SSMS))

[Задание 2.](https://github.com/S1l1c1um/Bd_labss/blob/main/lab5/part2.sql)
Выполнить маскирование некоторых поле Ваших таблиц  2-мя различными методами:
1. ALTER COLUMN LastName ADD MASKED WITH (FUNCTION = 'partial(2,"xxxx",0)')
2. Используя механизмы представлений, хранимых процедур и функций. Члены 1 роли должны видеть оригинальные данные, члены 2 роли маскированные.

<a id="lab6"></a>
# Лабораторная работа №6
[Назад](#content)

Используя реляционную БД из лабораторной работы №2:
- продумать и создать графовые таблицы по реляционной БД, заполнить графовые таблицы, используя данные в реляционных таблицах
- написать запросы из задания 3.2 используя паттерн MATCH
- сравнить полученные результаты с результатами запросов к реляционной модели
- создать схему узлов и ребер

[SQL-код создания и заполнения графовых таблиц](https://github.com/S1l1c1um/Bd_labss/blob/main/lab6/create_graph_tables.sql)

[Сравнение запросов]()

#### Схема узлов и ребер
![image]()







